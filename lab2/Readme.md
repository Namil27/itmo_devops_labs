## Докерфайл с Bad Practices
```
# 1. Использование тяжелого базового образа
FROM ubuntu:latest

# 2. Установка обновлений при каждом запуске контейнера
RUN apt-get update && apt-get install -y python3

# 3. Копирование всех файлов из текущей директории
COPY . /app

WORKDIR /app
CMD ["python3", "app.py"]
```

 1. Образ ubuntu:latest включает в себя много лишнего, из-за чего увеличивается размер контейнера. Лучше использовать минимальные образы, созданные под конкретные задачи, например python:3.9-slim, так как они содержат только конкретные компоненты.
 2. Обновление на стадии сборки Dockerfile делает сборку непредсказуемой и может нарушить работу контейнера в будущем, если новые обновления изменят зависимости. Лучше устанавливать только необходимые библиотеки из requirements.txt с указанием версий.
 3. Команда COPY . /app, которая копирует все файлы и папки из текущей директории в контейнер может привести к копированию ненужных файлов, таких как временные файлы, результаты тестов или файлов локальной конфигурации, что увеличивает размер образа. Использование .dockerignore позволяет исключить ненужные файлы из копирования в контейнер, что уменьшает его размер. 

## Исправленный докерфайл с Best Practices
```
# 1. Используем минимальный базовый образ
FROM python:3.9-slim

# 2. Устанавливаем необходимые зависимости, фиксируя их версии
COPY requirements.txt /app/requirements.txt
RUN pip install --no-cache-dir -r /app/requirements.txt

# 3. Копируем только нужные файлы, исключая ненужные через .dockerignore
COPY . /app

WORKDIR /app
CMD ["python3", "app.py"]
```
# Дополнительные задачи
## Docker-compose с Bad Practices
```
version: '3'

services:
  app:
    image: myapp:latest
    ports:
      - "80:80"  # Использование стандартного порта 80 для внешнего доступа.
    environment:
      - DEBUG=true  # Использование переменной окружения для включения debug режима в production.
    volumes:
      - ./app:/usr/src/app  # Использование локальных томов для приложений в production.
```
## Docker-compose с Best Practices

 1. Использование порта 80 для внешнего доступа является небезопасным в production среде, так как это стандартный порт для HTTP, что может увеличить риск атак. Лучше использовать нестандартные порты.
 2. Включение режима отладки (DEBUG=true) в production среде может предоставить злоумышленникам доступ к конфиденциальной информации. Debug режим всегда должен быть отключен в production.
 3. Применение локальных томов (host-based) в production может привести к проблемам с переносимостью и управлением версий файлов между контейнерами. Лучше использовать Docker тома для сохранения данных.

```
version: '3'

services:
  app:
    image: myapp:latest
    ports:
      - "8080:80"  # Используем нестандартный внешний порт для повышения безопасности.
    environment:
      - DEBUG=false  # Отключение режима отладки в production.
    volumes:
      - app-data:/usr/src/app  # Использование Docker тома для данных приложения.

volumes:
  app-data:  # Определяем том для хранения данных.
```