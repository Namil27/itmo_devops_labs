### Лабораторная работа 3: Настройка CI/CD

#### Введение

В этой лабораторной работе мы настраивали CI/CD для пет-проекта с веб-сервером и Flask-приложением. Сначала мы создали CI/CD файл с несколькими "плохими практиками", а затем исправили его, применив лучшие практики.

Файл CI/CD находится в .github/workflows и называется main.yml.

#### Шаг 1: Написание "плохого" CI/CD файла

Изначально CI/CD файл включал следующие "плохие практики":

1. Использование последней версии ОС (`runs-on: ubuntu-latest`)  
   _Почему это плохо:_ Последняя версия ОС может быть нестабильной.  
   _Исправление:_ Мы зафиксировали версию ОС на ubuntu-20.04 для стабильности.

2. Установка Docker Compose через `apt-get`  
   _Почему это плохо:_ Установка Docker Compose каждый раз замедляет процесс.  
   _Исправление:_ Заменили установку через apt-get на встроенный шаблон установки docker compose в github action.

3. Отсутствие кэширования Docker-слоев  
   _Почему это плохо:_ Полная пересборка контейнеров занимает много времени.  
   _Исправление:_ Мы добавили кэширование Docker-слоев с помощью actions/cache@v3, что ускорило процесс сборки.

4. Деплой с `docker-compose down` перед `docker-compose up`  
   _Почему это плохо:_ Остановка контейнеров может вызвать кратковременный простой сервисов.  
   _Исправление:_ Мы изменили команду на docker-compose up -d --build --no-deps, что позволяет перезапускать контейнеры без остановки.

5. Отсутствие кэширования зависимостей в тестах  
   _Почему это плохо:_ Установка зависимостей перед тестированием замедляет выполнение тестов.  
   _Исправление:_ Мы добавили кэширование зависимостей с помощью actions/cache@v3, что ускорило процесс тестирования.

#### Шаг 2: Написание "хорошего" CI/CD файла

После анализа и исправления проблем в "плохом" файле, мы переписали CI/CD файл с учётом лучших практик:

- Зафиксировали версию ОС на ubuntu-20.04 для стабильности.
- Заменили установку через apt-get на встроенный шаблон установки docker compose в github action.
- Внедрили кэширование Docker-слоев и зависимостей для ускорения сборки и тестирования.
- Изменили процесс деплоя на docker-compose up -d --build --no-deps для минимизации простоя.
- Добавили кэширование зависимостей в тестах для ускорения выполнения тестов.

#### Заключение

Мы улучшили CI/CD пайплайн, сделав его более стабильным и эффективным. Исправления уменьшили время сборки и деплоя и снизили вероятность возникновения проблем, обеспечивая более быстрые и надежные результаты.
