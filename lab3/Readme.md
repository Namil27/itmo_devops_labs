### Лабораторная работа 3: Настройка CI/CD

#### Введение

В этой лабораторной работе мы сосредоточились на настройке CI/CD для пет-проекта с веб-сервером и Flask-приложением. Сначала мы создали "плохой" CI/CD файл с рядом проблем, а затем исправили его, применив лучшие практики.

Файл CI/CD находится в .github/workflows и называется main.yml.

#### Шаг 1: Написание "плохого" CI/CD файла

Изначально созданный CI/CD файл содержал следующие "плохие практики":

1. Использование последней версии ОС (`runs-on: ubuntu-latest`)  
   _Почему это плохо:_ Последняя версия Ubuntu может изменить свои компоненты, что приводит к нестабильности сборок.  
   _Исправление:_ Мы зафиксировали версию ОС на ubuntu-20.04 для стабильности.

2. Установка Docker Compose через `apt-get`  
   _Почему это плохо:_ Установка Docker Compose каждый раз замедляет процесс сборки и деплоя.  
   _Исправление:_ Заменили установку Docker Compose на использование команды docker compose, встроенной в Docker CLI.

3. Отсутствие кэширования Docker-слоев  
   _Почему это плохо:_ Пересборка контейнеров каждый раз занимает много времени.  
   _Исправление:_ Добавили кэширование Docker-слоев с помощью actions/cache@v3, что ускорило сборку.

4. Деплой с `docker-compose down` перед `docker-compose up`  
   _Почему это плохо:_ Остановка контейнеров может вызвать кратковременный простой сервисов.  
   _Исправление:_ Использовали команду docker-compose up -d --build --no-deps, чтобы перезапустить контейнеры без остановки и минимизировать простой.

5. Отсутствие кэширования зависимостей в тестах  
   _Почему это плохо:_ Установка зависимостей перед тестированием каждый раз замедляет процесс.  
   _Исправление:_ Добавили кэширование зависимостей с помощью actions/cache@v3, что ускорило тестирование.

#### Шаг 2: Написание "хорошего" CI/CD файла

После исправления "плохих" практик мы переписали CI/CD процесс:

- Зафиксировали версию ОС для обеспечения стабильности сборок.
- Использовали встроенную в Docker CLI команду docker compose для установки.
- Внедрили кэширование Docker-слоев и зависимостей для ускорения процессов.
- Изменили процесс деплоя для минимизации времени простоя сервисов.

#### Заключение

В результате лабораторной работы мы улучшили CI/CD пайплайн, сделав его более стабильным и эффективным. Исправления значительно сократили время сборки и деплоя, а также снизили вероятность возникновения проблем.